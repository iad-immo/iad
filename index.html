<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calcul des commissions IAD</title>

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="theme-color" content="#003a70">

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background:#f5f9ff;
      color:#003a70;
    }
    .container {
      max-width:720px;
      margin:0 auto;
      background:white;
      padding:20px;
      border-radius:10px;
      box-shadow:0 6px 18px rgba(0,0,0,0.06);
    }
    input[type=number] {
      padding:8px;
      width:260px;
    }
    .result {
      margin-top:16px;
      font-weight:600;
    }
    .breakdown {
      margin-top:12px;
      background:#f0f7ff;
      padding:12px;
      border-radius:8px;
    }
    .line {
      display:flex;
      justify-content:space-between;
      padding:6px 0;
    }
    header {
      display:flex;
      align-items:center;
      gap:20px;
      margin-bottom:10px;
    }
  </style>
</head>

<body>
<div class="container">

  <header>
<img src="https://www.immodvisor.com/img/company/logo/86/nwa68ff2ff8045fb1972.png" alt="IAD" style="height:60px;"/>
    <div>
      <h1 style="margin:0; font-size:20px;">Calcul des commissions IAD</h1>
      <div style="font-size:13px;">
        + simulation auto-entrepreneur (-26,1% – 2026)
      </div>
    </div>
  </header>

  <label>Commissions HT facturées (€) :</label><br>
  <input type="number" id="commission" step="0.01" oninput="calculer()" />

  <div class="breakdown" id="breakdown" style="display:none;">
    <div class="line"><div>Montant total facturé</div><div id="totalFacture"></div></div>
    <hr />
    <div id="lines"></div>
    <hr />
    <div class="line"><div>TOTAL perçu avant charges</div><div id="totalPerçu"></div></div>
    <div class="line"><div>En auto-entreprise après URSSAF (-26,1%)</div><div id="apresUrssaf"></div></div>
  </div>

</div>

<script>
function format(v){
  return v.toLocaleString('fr-FR',{minimumFractionDigits:2,maximumFractionDigits:2}) + ' €';
}

function calculer(){
  const val = parseFloat(document.getElementById('commission').value);
  const breakdown = document.getElementById('breakdown');
  const lines = document.getElementById('lines');

  if(isNaN(val) || val <= 0){
    breakdown.style.display='none';
    return;
  }

  breakdown.style.display='block';
  document.getElementById('totalFacture').textContent = format(val);

  const p1 = 0.69;
  const p2 = 0.75;
  const p3 = 0.80;
  const p4 = 0.85;

  const t1 = 65000;
  const t2 = 80000;
  const t3 = 100000;

  let remaining = val;
  let totalPerçu = 0;
  let html = "";

  // Tranche 1
  const tranche1 = Math.min(remaining, t1);
  const percu1 = tranche1 * p1;
  html += `<div class="line"><div>Sur les 0 → 65 000 à 69% :</div><div>${format(percu1)}</div></div>`;
  totalPerçu += percu1;
  remaining -= tranche1;

  // Tranche 2
  if(remaining > 0){
    const tranche2 = Math.min(remaining, t2 - t1);
    const percu2 = tranche2 * p2;
    html += `<div class="line"><div>Sur la tranche 65 000 → 80 000 à 75% :</div><div>${format(percu2)}</div></div>`;
    totalPerçu += percu2;
    remaining -= tranche2;
  }

  // Tranche 3
  if(remaining > 0){
    const tranche3 = Math.min(remaining, t3 - t2);
    const percu3 = tranche3 * p3;
    html += `<div class="line"><div>Sur la tranche 80 000 → 100 000 à 80% :</div><div>${format(percu3)}</div></div>`;
    totalPerçu += percu3;
    remaining -= tranche3;
  }

  // Tranche 4
  if(remaining > 0){
    const tranche4 = remaining;
    const percu4 = tranche4 * p4;
    html += `<div class="line"><div>Sur la tranche > 100 000 à 85% :</div><div>${format(percu4)}</div></div>`;
    totalPerçu += percu4;
    remaining -= tranche4;
  }

  lines.innerHTML = html;

  document.getElementById('totalPerçu').textContent = format(totalPerçu);

  const apres = totalPerçu * (1 - 0.261);
  document.getElementById('apresUrssaf').textContent = format(apres);
}
</script>

</body>
</html>